<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GxE</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="GxE_files/libs/clipboard/clipboard.min.js"></script>
<script src="GxE_files/libs/quarto-html/quarto.js"></script>
<script src="GxE_files/libs/quarto-html/popper.min.js"></script>
<script src="GxE_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GxE_files/libs/quarto-html/anchor.min.js"></script>
<link href="GxE_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GxE_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GxE_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GxE_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GxE_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GxE</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Introduction: Nowadays, climate change is a pretty serious phenomenon and that’s why everyone is paying a lot of attention to it. climate change has significant impacts on various sectors, including animal production. climate change is affecting milk production, both the quantity of production and its composition. Heat stress negatively affects the cows’ comfort and overall health. Spain is one of the countries that is most affected by this climate change, since its affect varies between the north and the south of this country. As a geneticist, we have to study how the expression of the production characters of milk, fat and protein is changed in different zones of Spain (CC, MN, ES).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("thomasp85/patchwork")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("gridExtra")  # Instalar el paquete gridExtra</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#if (packageVersion("devtools") &lt; 1.6) {</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  install.packages("devtools")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#}</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("hadley/lazyeval")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("hadley/dplyr")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Loading Libraries</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2.9000     ✔ readr     2.1.4     
✔ forcats   1.0.0          ✔ stringr   1.5.0     
✔ ggplot2   3.4.2          ✔ tibble    3.2.1     
✔ lubridate 1.9.2          ✔ tidyr     1.3.0     
✔ purrr     1.0.1          
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------
You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)
------------------------------------------------------------------------------

Attaching package: 'plyr'

The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following object is masked from 'package:purrr':

    compact</code></pre>
</div>
</div>
<p>Editing the data Only we used the data of the 1 lactation of the 3 Zones of Spain</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">### crear un spacio de trabajo</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"K:</span><span class="sc">\\</span><span class="st">Trabajo Maria Jesus</span><span class="sc">\\</span><span class="st">EstudioGxE</span><span class="sc">\\</span><span class="st">GxE_files"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the data</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Rumlac01_SCS.txt"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1592634      29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos_raw)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"R_SC"</span>,<span class="st">"S_SC"</span>,<span class="st">"MP"</span>,<span class="st">"Fat"</span>,<span class="st">"P"</span>,<span class="st">"F_p"</span>,<span class="st">"P_p"</span>,<span class="st">"Loc"</span>,<span class="st">"H_Y_S"</span>,<span class="st">"H_COn_D"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"L_Age"</span>,<span class="st">"Co_DIM"</span>,<span class="st">"DIM"</span>,<span class="st">"Animal"</span>,<span class="st">"hetdimthi"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"hetdimthiclass"</span>,<span class="st">"cov1_thimu012"</span>,<span class="st">"cov2_thimu012"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"cov3_thimu012"</span>,<span class="st">"cov1_dim"</span>,<span class="st">"cov2_dim"</span>,<span class="st">"cov3_dim"</span>,<span class="st">"CO_Herd"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"N_Part_L"</span>,<span class="st">"D_Control"</span>,<span class="st">"F_PARTO"</span>,<span class="st">"dist_t"</span>,<span class="st">"dist_hr"</span>,<span class="st">"THI012"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ####### Redondear la variable THI012 a 2 decimales##############</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">THI012 =</span> <span class="fu">round</span>(THI012, <span class="dv">0</span>))</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">############ crear la columina zona en España  con solo 3 zonas ############</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Zona =</span><span class="fu">case_when</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    Loc<span class="sc">==</span><span class="st">'G'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'S'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'J'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'V'</span><span class="sc">~</span><span class="st">'CC'</span>, <span class="co"># Cornisa cantábrica</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    Loc<span class="sc">==</span><span class="st">'L'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'P'</span><span class="sc">~</span><span class="st">'MN'</span>,  <span class="co"># Mesa norte</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    Loc<span class="sc">==</span><span class="st">'C'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'N'</span><span class="sc">|</span>Loc<span class="sc">==</span><span class="st">'A'</span><span class="sc">~</span><span class="st">'ES'</span> <span class="co"># España seca</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">########### separar herd-year-season a (Herd y la fecha (que es season_year)) ###########</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span>datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Herd =</span> <span class="fu">str_extract</span>(H_Y_S, <span class="st">"</span><span class="sc">\\</span><span class="st">d+"</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">fecha =</span> <span class="fu">str_replace</span>(H_Y_S, <span class="st">".*_(</span><span class="sc">\\</span><span class="st">d{4}_</span><span class="sc">\\</span><span class="st">d+)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="do">################### sperar L_Age a (Lact, la edad (Age)) ######</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lact =</span> <span class="fu">case_when</span>(<span class="fu">substr</span>(L_Age, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">substr</span>(L_Age, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">==</span> <span class="st">"3"</span> <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                          <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">2</span>),</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Age =</span> <span class="fu">substr</span>(L_Age, <span class="dv">2</span>, <span class="dv">4</span>))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="do">########################### concatenar lact con Zona  ############</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Zona_lact =</span> <span class="fu">paste</span>(Zona,Lact,  <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R_SC      S_SC   MP     Fat       P  F_p  P_p Loc          H_Y_S
4    63 2.3334237 24.0 0.96240 0.76800 4.01 3.20   V V010145_2012_4
6    34 1.4436067 25.0 0.95750 0.79000 3.83 3.16   V V010145_2011_3
7    39 1.6415460 27.0 0.92880 0.87480 3.44 3.24   V V010145_2011_3
8    36 1.5260688 26.0 0.89700 0.85280 3.45 3.28   V V010145_2011_3
11   20 0.6780719 29.0 1.17740 0.84390 4.06 2.91   V V010153_2011_1
13   38 1.6040713 34.2 1.27224 1.03968 3.72 3.04   V V010153_2011_1
              H_COn_D L_Age Co_DIM DIM         Animal hetdimthi hetdimthiclass
4  V010145_2012-01-03  1036     10 281 ESPH0102964081        31              7
6  V010145_2011-10-03  1036      7 189 ESPH0102964081        22              5
7  V010145_2011-11-03  1036      8 220 ESPH0102964081        22              5
8  V010145_2011-12-04  1036      9 251 ESPH0102964081        21              4
11 V010153_2011-04-25  1033      4  92 ESPH0102964627        11              1
13 V010153_2011-06-26  1033      6 154 ESPH0102964627        22              5
   cov1_thimu012 cov2_thimu012 cov3_thimu012    cov1_dim    cov2_dim   cov3_dim
4    -0.65335809     0.1403152     0.2827786  0.83157895  0.53728532  0.1902726
6     0.31923930    -0.3471294    -0.3975218  0.18596491 -0.44812558 -0.2628693
7     0.09443756    -0.4866223    -0.1395507  0.40350877 -0.25577101 -0.4410156
8    -0.45995637    -0.1826602     0.4466638  0.62105263  0.07855956 -0.3327191
11   -0.15458716    -0.4641542     0.2226452 -0.49473684 -0.13285319  0.4393702
13    0.35930799    -0.3063467    -0.4229933 -0.05964912 -0.49466297  0.0889431
   CO_Herd N_Part_L  D_Control    F_PARTO    dist_t   dist_hr THI012 Zona
4  V010145        1 2012-01-03 2011-03-28  2.562661  2.562661     47   CC
6  V010145        1 2011-10-03 2011-03-28  2.562661  2.562661     66   CC
7  V010145        1 2011-11-03 2011-03-28  2.562661  2.562661     62   CC
8  V010145        1 2011-12-04 2011-03-28  2.562661  2.562661     51   CC
11 V010153        1 2011-04-25 2011-01-23 10.211377 10.211377     57   CC
13 V010153        1 2011-06-26 2011-01-23 10.211377 10.211377     67   CC
     Herd  fecha Lact Age Zona_lact
4  010145 2012_4    1 036      CC_1
6  010145 2011_3    1 036      CC_1
7  010145 2011_3    1 036      CC_1
8  010145 2011_3    1 036      CC_1
11 010153 2011_1    1 033      CC_1
13 010153 2011_1    1 033      CC_1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################################################</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">############################# creat THI clases #############################</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">THI_c =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">40</span>, <span class="dv">41</span>) <span class="sc">~</span> <span class="dv">1</span>,  <span class="fu">between</span>(THI012, <span class="dv">42</span>, <span class="dv">43</span>) <span class="sc">~</span> <span class="dv">2</span>,  <span class="fu">between</span>(THI012, <span class="dv">44</span>, <span class="dv">45</span>) <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">46</span>, <span class="dv">47</span>) <span class="sc">~</span> <span class="dv">4</span>,  <span class="fu">between</span>(THI012, <span class="dv">48</span>, <span class="dv">49</span>) <span class="sc">~</span> <span class="dv">5</span>,  <span class="fu">between</span>(THI012, <span class="dv">50</span>, <span class="dv">51</span>) <span class="sc">~</span> <span class="dv">6</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">52</span>, <span class="dv">53</span>) <span class="sc">~</span> <span class="dv">7</span>,  <span class="fu">between</span>(THI012, <span class="dv">54</span>, <span class="dv">55</span>) <span class="sc">~</span> <span class="dv">8</span>,  <span class="fu">between</span>(THI012, <span class="dv">56</span>, <span class="dv">57</span>) <span class="sc">~</span> <span class="dv">9</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">58</span>, <span class="dv">59</span>) <span class="sc">~</span> <span class="dv">10</span>, <span class="fu">between</span>(THI012, <span class="dv">60</span>, <span class="dv">61</span>) <span class="sc">~</span> <span class="dv">11</span>, <span class="fu">between</span>(THI012, <span class="dv">62</span>, <span class="dv">63</span>) <span class="sc">~</span> <span class="dv">12</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">64</span>, <span class="dv">65</span>) <span class="sc">~</span> <span class="dv">13</span>, <span class="fu">between</span>(THI012, <span class="dv">66</span>, <span class="dv">67</span>) <span class="sc">~</span> <span class="dv">14</span>, <span class="fu">between</span>(THI012, <span class="dv">68</span>, <span class="dv">69</span>) <span class="sc">~</span> <span class="dv">15</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">70</span>, <span class="dv">71</span>) <span class="sc">~</span> <span class="dv">16</span>, <span class="fu">between</span>(THI012, <span class="dv">72</span>, <span class="dv">73</span>) <span class="sc">~</span> <span class="dv">17</span>, <span class="fu">between</span>(THI012, <span class="dv">74</span>, <span class="dv">75</span>) <span class="sc">~</span> <span class="dv">18</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(THI012, <span class="dv">76</span>, <span class="dv">77</span>) <span class="sc">~</span> <span class="dv">19</span>, <span class="fu">between</span>(THI012, <span class="dv">78</span>, <span class="dv">79</span>) <span class="sc">~</span> <span class="dv">20</span>, <span class="fu">between</span>(THI012, <span class="dv">80</span>, <span class="dv">81</span>) <span class="sc">~</span> <span class="dv">21</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span>  ))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">########################## concatinar la Zone y THI_c ####################</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">THI_Zona =</span> <span class="fu">paste</span>(Zona,THI_c,  <span class="at">sep =</span> <span class="st">"_"</span>))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="do">################ create MP as a different traits en each zone ############</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_CC =</span> MP,</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_MN =</span> MP,</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_ES =</span> MP</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="do">################### cambios condicionales en las columnas MPdepende la zona #####</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># in case CC</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, MP_MN),</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, MP_ES),</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, MP_CC),<span class="co"># in case MN</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, MP_ES),</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, MP_MN),<span class="co"># in case ES</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">MP_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, MP_CC)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a><span class="do">################ create fat as a different traits en each zone ############</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_CC =</span> Fat,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_MN =</span> Fat,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_ES =</span> Fat</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a><span class="do">################### cambios condicionales en las columnas MPdepende la zona #####</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a><span class="co"># in case CC</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, Fat_MN),</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, Fat_ES),</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, Fat_CC),<span class="co"># in case MN</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, Fat_ES),</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, Fat_MN),<span class="co"># in case ES</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">Fat_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, Fat_CC)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a><span class="do">################ create protein as a different traits en each zone ############</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_CC =</span> P,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_MN =</span> P,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_ES =</span> P</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a><span class="do">################### cambios condicionales en las columnas MPdepende la zona #####</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="co"># in case CC</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, P_MN),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, P_ES),</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, P_CC),<span class="co"># in case MN</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, P_ES),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, P_MN),<span class="co"># in case ES</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, P_CC)</span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a><span class="do">################ create fat as a different traits en each zone ############</span></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_CC =</span> F_p,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_MN =</span> F_p,</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_ES =</span> F_p</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a><span class="do">################### cambios condicionales en las columnas MPdepende la zona #####</span></span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a><span class="co"># in case CC</span></span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, F_p_MN),</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, F_p_ES),</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, F_p_CC),<span class="co"># in case MN</span></span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, F_p_ES),</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, F_p_MN),<span class="co"># in case ES</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">F_p_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, F_p_CC)</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a><span class="do">################ create protein as a different traits en each zone ############</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>datos_raw<span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_CC =</span> P_p,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_MN =</span> P_p,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_ES =</span> P_p</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a><span class="do">################### cambios condicionales en las columnas MPdepende la zona #####</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a><span class="co"># in case CC</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, P_p_MN),</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"CC"</span>, <span class="dv">0</span>, P_p_ES),</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, P_p_CC),<span class="co"># in case MN</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_ES =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"MN"</span>, <span class="dv">0</span>, P_p_ES),</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_MN =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, P_p_MN),<span class="co"># in case ES</span></span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">P_p_CC =</span> <span class="fu">ifelse</span>(Zona <span class="sc">==</span> <span class="st">"ES"</span>, <span class="dv">0</span>, P_p_CC)</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a><span class="do">######################</span></span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>datos_raw <span class="ot">&lt;-</span> datos_raw <span class="sc">%&gt;%</span></span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">THI =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>      Zona <span class="sc">==</span> <span class="st">"CC"</span> <span class="sc">~</span> THI012 <span class="sc">-</span> <span class="fl">67.86</span>,</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>      Zona <span class="sc">==</span> <span class="st">"MN"</span> <span class="sc">~</span> THI012 <span class="sc">-</span> <span class="fl">69.5</span>,</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>      Zona <span class="sc">==</span> <span class="st">"ES"</span> <span class="sc">~</span> THI012 <span class="sc">-</span> <span class="fl">75.04</span>,</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> THI012</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading pedigree</span></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>Ped<span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"ped.dat"</span>, <span class="at">h=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Ped)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Animal"</span>,<span class="st">"sire"</span>,<span class="st">"dam"</span>)</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Ped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6050368       3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################### merge the data with pedigree file ###################</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">merge</span>(datos_raw,Ped,  <span class="at">by =</span> <span class="st">"Animal"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1592634      53</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1592634      55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">################  Escribir el objeto datos_raw en un archivo de texto para los analysis ###################################</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                MP_CC, MP_MN, MP_ES, Fat_CC, Fat_MN, Fat_ES,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                P_CC, P_MN, P_ES, F_p_CC, F_p_MN, F_p_ES,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                P_p_CC, P_p_MN, P_p_ES, Lact, H_Y_S, L_Age,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                Zona_lact, Age, THI, sire, Animal, THI_Zona, THI_c,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                THI012, cov1_thimu012, cov2_thimu012, cov3_thimu012, cov1_dim,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                cov2_dim, cov3_dim, CO_Herd, R_SC, S_SC, Loc,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                H_COn_D, Co_DIM, DIM, hetdimthi, hetdimthiclass,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                N_Part_L, D_Control, F_PARTO, Zona, Herd, fecha</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                ) </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(dat,<span class="st">"data.txt"</span>,<span class="at">quote=</span><span class="cn">FALSE</span>,<span class="at">col.names=</span><span class="cn">FALSE</span>,<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>